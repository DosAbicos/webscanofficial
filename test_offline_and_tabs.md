# Тестирование офлайн режима и работы с несколькими вкладками

## Вопрос 1: Офлайн режим

### Текущее состояние:
- ✅ IndexedDB хранит данные локально в браузере
- ✅ После первой загрузки данные доступны офлайн
- ⚠️ При первом открытии требуется интернет для:
  - Загрузки sample_file.xls
  - Загрузки JavaScript кода приложения

### Офлайн функционал:
1. **Просмотр товаров** ✅ - работает офлайн
2. **Поиск товаров** ✅ - работает офлайн
3. **Добавление штрихкодов** ✅ - работает офлайн (IndexedDB)
4. **Редактирование** ✅ - работает офлайн
5. **Удаление** ✅ - работает офлайн
6. **Экспорт** ❌ - требует интернет (вызов backend API)

### Рекомендация для полного офлайн:
Для полностью офлайн работы нужно:
1. Service Worker для кеширования приложения
2. Экспорт через клиентский JavaScript (xlsx.js)
3. Кеширование sample_file.xls

## Вопрос 2: Несколько вкладок/окон

### Как работает IndexedDB:
- **База данных ОБЩАЯ** для всех вкладок одного браузера
- **НЕ удаляется** при открытии новой вкладки
- **Синхронизируется** между вкладками

### Сценарии:

#### Сценарий 1: Открыть в новой вкладке
```
1. Вкладка 1: Добавлено 5 товаров со штрихкодом
2. Открыть новую вкладку (та же ссылка)
3. Результат: ✅ Все 5 товаров видны во второй вкладке
```

#### Сценарий 2: Закрыть и открыть браузер
```
1. Добавлено 5 товаров со штрихкодом
2. Закрыть браузер полностью
3. Открыть браузер и зайти на сайт
4. Результат: ✅ Все 5 товаров сохранены
```

#### Сценарий 3: Работа в двух вкладках одновременно
```
1. Вкладка 1: Добавлен товар A
2. Вкладка 2: Добавлен товар B
3. Вкладка 1: Обновить страницу
4. Результат: ✅ Видны оба товара (A и B)
```

#### Сценарий 4: Приватный режим (Incognito)
```
1. Обычный режим: Добавлено 5 товаров
2. Открыть приватный режим (Incognito)
3. Результат: ❌ Товары НЕ видны (отдельная база данных)
```

### Когда данные УДАЛЯЮТСЯ:
1. ❌ Ручное удаление через DevTools (Application → IndexedDB → Delete)
2. ❌ Очистка кеша браузера (если включена опция удаления баз данных)
3. ❌ Приватный режим (после закрытия всех приватных вкладок)

### Когда данные СОХРАНЯЮТСЯ:
1. ✅ Перезагрузка страницы
2. ✅ Новая вкладка/окно
3. ✅ Перезагрузка браузера
4. ✅ Перезагрузка компьютера
5. ✅ Офлайн режим

## Итоговые ответы:

### 1. Офлайн режим:
**Да, но с ограничением:**
- ✅ Просмотр, поиск, добавление, редактирование - работает офлайн
- ❌ Экспорт Excel - требует интернет (backend API)
- ✅ После первой загрузки можно работать без интернета

### 2. Новое окно/вкладка:
**Нет, данные НЕ сотрутся:**
- ✅ IndexedDB общая для всех вкладок
- ✅ Данные сохраняются между сеансами
- ✅ Можно работать в нескольких вкладках одновременно
